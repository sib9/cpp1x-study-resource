
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>强类型枚举</title>
   <meta name="author" content="Sib9" />

   <link rel="start" href="/" />

	
	
	
	

   <!-- use google open sans -->
   <link href="http://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/screen.css" type="text/css" />

   <!-- sib9 common css -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/sib9_common.css" type="text/css" />
   
</head>
<body id="">
<div id="site">
  <a href="https://github.com/sib9/cpp1x-study-resource"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

  
<div id="page">
	
  <h1 class="emphnext">强类型枚举</h1>

  <div id="content">
    <p>译自： <a href="http://www.cprogramming.com/c++11/c++11-nullptr-strongly-typed-enum-class.html">Better types in C++11 - nullptr, enum classes (strongly typed enumerations) and cstdint</a>;</p>

<p>C++03 的枚举本质上就是整型，它们可以和整型，和其它的枚举类型做比较。实际上，你并不希望不同枚举之间进行比较，就好像你不希望把钉子的种类和牙刷的种类做比较一样。</p>

<p>旧式枚举的另外一个限制是枚举的值是没有作用域的，换句话说，你不能两个枚举共享同一个名字，比如：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">enum Color {RED, GREEN, BLUE};
enum Feeling {EXCITED, MOODY, BLUE}; // error: redeclaration of ‘BLUE’
</code></pre></div>
<p>C++11 提供了强类型枚举——枚举类(enum classes)，如下方式声明：</p>

<p><code>class</code>意味着每一个枚举类型实际上都是不一样的，不能和其它类型做比较。强类型枚举，枚举类有很好的作用域。每个枚举值作用域被限制在枚举类中。这意味着，想要存取枚举值，你必须要这么用：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Color color = Color::GREEN;
if (Color::RED == color) {
    // the color is red;
}
</code></pre></div>
<p>如果你想用旧式的枚举，仍旧是可用的。很大程度上，是可以和既有的代码相兼容的。教你一招，现在你可以直接在值前面加上枚举名：Color::RED.但是这种情况下，不能解决命名冲突的问题，它只是更清晰了一些。</p>

<p>枚举类比旧式枚举类型另外一个优势是，你可以使用前向声明一个强枚举类型，意味着你可以这样写代码：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">enum class Mood;
void assessMode (Mood m);
enum class {EXCITED, MOODY, BLUE};
</code></pre></div>
<p>Why would this be useful? Forward declarations are often about the physical layout of code on disk into different files or to provide opaque objects as part of an API. In the first case, where you care about the physical disk layout, using a forward declaration allows you to declare an enum type in the header file while putting specific values into the cpp file. This lets you change the list of possible enum values quite frequently without forcing all dependent files to recompile. In the second case, an enum class can be exposed as a type-safe but otherwise opaque value returned from one API function to be passed into another API function. The code using the API need not know the possible values the type can take on. Since the compiler still knows about the type, it can enforce that variables declared to work with that type are not confused with variables working with another type. (译者注：这段话不太理解，所有没有翻译，欢迎补充翻译。)</p>

<p>枚举类的最后一个好处是你可以你的枚举的大小，你可以使用任何签名的或者未签名的整型类。默认是 int ，但是你也可以使用 char, unsigned long 等等。这样可以确保跨平台编译器的兼容性。</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">enum class Colors : char { RED = 1, GREEN = 2, BLUE = 3 };
</code></pre></div>
<p>但是在在 C++11 中，在指定类型大小上，我们可以用更好的方式，使用 <code>cstdint</code>。</p>

<p>C++ 在类型方面存在一个问题，比如说，你想要一个 32位 的整型，但是 int 可能在不同体系架构下有不同的大小。在 C++11 中，C99 的头文件 <code>stdint.h</code> 包含在 <code>cstdint</code> 中。<code>cstdint</code> 头文件包含了诸如 <code>std::int8_t</code>, <code>std::int32_t</code> 和 <code>int64_t</code>(对应的 unsigned 版本是从 <code>std::uint8_t</code> 开始的)的类型。</p>

<p>下面是使用新类型和枚举类完美配合，告诉跨平台编译器和体系架构你的枚举大小：</p>

<p>enum class Colors: std::int8_t { RED = 1, GREEN = 2, BLUE = 3};</p>

<h2 id="toc_0">扩展资料</h2>

<ul>
<li><a href="http://www.cprogramming.com/c++11/c++11-nullptr-strongly-typed-enum-class.html">Better types in C++11 - nullptr, enum classes (strongly typed enumerations) and cstdint</a></li>
<li><a href="https://en.wikipedia.org/wiki/C%2B%2B11#Strongly_typed_enumerations">Strongly typed enumerations</a></li>
</ul>

  </div>

  <div id="sidebar">
    <div id="about">
      <h3>关于网站</h3>
      <p><a href="/">cpp1x.org</a> 是一个C++新标准的学习性网站，旨在搜集国内外各种C++标准(C++11及以后)资源，供大家参考、学习。</p>
      <p>网站资源大部分来自互联网，具体引用位置会在文章结尾标注，如果侵犯到您的合法权益，请您给我们发邮件，我们会进行相应的处理。</p>
      <p>欢迎大家提意见和建议，也希望大家可以投稿给我们。</p>
      <h3>关于我们</h3>
      <p><a href="http://sib9.us/">Sib9</a></p>
      <p>联系方式: us@sib9.us</p>
      
    </div>
    <div id="post_rel">
      <!-- <p><a href="/">目录(首页)</a></p> -->
      <!--  -->
      <!-- <p>上一篇: <a href="/Static-Assert.html" title="静态断言">静态断言</a></p> -->
      <!--  -->
      <!--  -->
      <!-- <p>下一篇: <a href="/Thread.html" title="线程">线程</a></p> -->
      <!--  -->
      <h3>目录</h3>
       
      <h4 id="document-ref">document</h4>
      <ul>
        
        


  
    
      
      	
      	<li><a href="/type-alias.html">类型别名</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/constexpr-and-const-expression.html">constexpr和常量表达式</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Unrestricted-Unions.html">无限制的 Unions</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Uniform-Initialization.html">统一的初始化方式</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Type-Inference.html">类型自动推导</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Thread.html">线程</a></li>
      	
      
    
  
    
      
      	
      	<li class="active"><a href="/Strong-Type-Enum.html" class="active">强类型枚举</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Static-Assert.html">静态断言</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Right-Angle-Bracket.html">右尖括号</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Range-based-For-Loop.html">基于范围的 for 循环</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/R-value-Ref-And-Move-Construct.html">Right value reference and move construct</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Object-Construction-Improvement.html">对象构造能力的提升</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Null-Pointer-Const.html">空指针常量</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/NewType-long-long-int.html">long long int 类型</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/New-String-Literals.html">新的字符串常量</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Lambda-Function-And-Expressions.html">Lambda 函数和表达式</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Initializer-lists.html">初始化列表</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Extern-Template.html">外部模板</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Explicitly-Defaulted-and-Deleted-Special-Member-Functions.html">显式使用或禁用特定的成员函数</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Explicit-Overrides-And-Final.html">显式重载和 Final 操作符</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Control-and-query-object-alignment.html">控制和查询对象布局</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/Alternative-Function-Syntax.html">新的函数声明语法</a></li>
      	
      
    
  



      </ul>
 
      <h4 id="compiler-ref">compiler</h4>
      <ul>
        
        


  
    
      
      	
      	<li><a href="/Install-GCC4.8-Ubuntu.html">Install GCC4.8 In Ubuntu 12.04</a></li>
      	
      
    
  



      </ul>

    </div>
  </div>

  <div id="statement">
  </div>
  
</div><!-- End Page -->

<div id="footer">
  Copyright by <a href="http://sib9.us/">Sib9</a>. Theme based on <a href="http://mark.reid.name/">Mark Reid</a>, Powered by <a href="http://github.com/mojombo/jekyll/">Jekyll.</a>
</div>
  



  
</div>

<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->

  
</body>
</html>

